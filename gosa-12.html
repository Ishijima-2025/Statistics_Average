<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ['\\(','\\)'] ],
    processEscapes: true
  },
  TeX: {
    extensions: ["mhchem.js"]
  },
  CommonHTML: {
    matchFontHeight: false
  }
});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>


	



<link href="160324.css" rel="stylesheet" type="text/css" />
<style type="text/css">
.style7 {color: #000000; }
</style>
<title>regression analysis</title>
</head>

<body>
<p class="X-Large-Bold-RED">直線近似の各推定値の誤差-02</p>
<p class="Large-Bold-Red">&nbsp;</p>
<p>直線近似の推定について，具体的な値を</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>x</td>
      <td>y</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <td>4</td>
      <td>9</td>
    </tr>
    <tr>
      <td>5</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
<p>とします．</p>
<p>\( \Large y = ax+b \)</p>
<p>による近似なので，</p>
<p>各パラメータは，</p>
<p>\( \Large  n = 5 \)</p>
<p>\( \Large  p = 2 \)</p>
<p>\( \Large  \overline{x} = \displaystyle  \frac{1+2+3+4+5}{5} = 3 \)</p>
<p>\( \Large  \overline{y} = \displaystyle  \frac{3+5+8+9+10}{5} = 7 \)</p>
<p>\( \Large  S_{xx} = \displaystyle \sum_{i=1}^n (x_i - \bar{x})^2  \)</p>
<p>\( \Large   = \displaystyle  (1-3)^2 +(2-3)^2+(3-3)^2+(4-3)^2+(5-3)^2  \)</p>
<p>\( \Large   = 4+1+0+1+4= 10 \)</p>
<p>\( \Large  S_{xy} = \displaystyle \sum_{i=1}^n (x_i - \bar{x}) (y_i - \bar{y}) \)</p>
<p>\( \Large = \displaystyle  (1-3)(3-7) +(2-3)(5-7)+(3-3)(8-7)+(4-3)(9-7)+(5-3)(10-7) \)</p>
<p>\( \Large =  8+2+0+2+6= 18 \)</p>
<p>&nbsp;</p>
<p>\( \Large a =   \displaystyle \frac{ S_{xy} }{ S_{xx}} = \frac{18}{10} = \color{red}{1.8} \)</p>
<p>\( \Large b = 
    \displaystyle \overline{y} - \frac{ S_{xy} }{ S_{xx}} \overline{x} = 7 - 1.8 \times 3 = \color{blue}{1.6} \)</p>
<p>となります．推定値は，</p>
<table width="200" border="1">
  <tbody>
    <tr>
      <td>x</td>
      <td>y</td>
      <td>\(\Large \hat{y} \)</td>
      <td>\(\Large y-\hat{y} \)</td>
    </tr>
    <tr>
      <td>1</td>
      <td>3</td>
      <td>3.4</td>
      <td>-0.4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5</td>
      <td>5.2</td>
      <td>-0.2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>9</td>
      <td>8.8</td>
      <td>0.2</td>
    </tr>
    <tr>
      <td>5</td>
      <td>10</td>
      <td>10.6</td>
      <td>-0.6</td>
    </tr>
  </tbody>
</table>
<p>となるので，ｙの推定値からの差分の二乗和は，</p>
<p>\( \Large    \displaystyle \sigma_y^2  = 
  \sum_{i=1}^N ( y_i - \hat{y})^2
\)</p>
<p>\( \Large    \displaystyle = (3-3.4)^2 + (5-5.2)^2 + (8-7)^2 + (9-8.8)^2 + (10-10.6)^2
\)</p>
<p>\( \Large    \displaystyle  = 0.16 + 0.04 + 1 + 0.04 + 0.36 = 1.6
\)</p>
<p>&nbsp;</p>
<p><span class="Red-Bold">推定誤差</span>は，</p>
<p>\( \Large    \displaystyle \sigma_a^2  = \displaystyle   
  \frac{ \sigma_y^2}{S_{xx}} 
= \frac{1.6}{10} = 0.16 \)</p>
<p>\( \Large    \displaystyle SE_a = \sqrt{ \frac{0.16}{5-2}} = \color{red}{0.23094} \)</p>
<p>\( \Large    \displaystyle  \sigma_b^2  = \sigma_y^2  
\left\{ \frac{1}{n}+ \frac{\left( \bar{x} \right)^2 }{S_{xx}} \right\} =  1.6 \times \left( \frac{1}{5} + \frac{3^2}{10} \right) = 1.76 \)</p>
<p>\( \Large    \displaystyle SE_b =\sqrt{ \frac{1.76}{5-2}} = \color{blue}{0.765942}\)</p>
<p>となります．</p>
<p>&nbsp;</p>
<p class="Large-Bold-Red">エクセルにおける推定誤差</p>
<p>エクセルにおいても，線形近似の場合は推定誤差を計算することができて，LINEST関数を用いれば，</p>
<p> =LINEST(C2:C6,B2:B6,TRUE,TRUE)</p>
<table width="200" border="1">
  <tr data-source-line="128">
    <th>a</th>
    <th>b</th>
  </tr>
  <tr data-source-line="130">
    <td class="Red">1.8</td>
    <td class="Blue">1.6</td>
  </tr>
  <tr data-source-line="131">
    <td class="Red">0.230940108</td>
    <td class="Blue">0.765941686</td>
  </tr>
  <tr data-source-line="132">
    <td>0.952941176</td>
    <td>0.730296743</td>
  </tr>
  <tr data-source-line="133">
    <td>60.75</td>
    <td>3</td>
  </tr>
  <tr data-source-line="134">
    <td>32.4</td>
    <td>1.6</td>
  </tr>
  <tbody>
  </tbody>
</table>
<p>との結果を得ることができます．各項目は，</p>
<table width="349" border="1">
  <tr data-source-line="138">
    <th width="74">行 / 列</th>
    <th width="113">1列目</th>
    <th width="140">2列目</th>
  </tr>
  <tr data-source-line="140">
    <td>1行目</td>
    <td class="Red">傾き（m）</td>
    <td class="Blue">切片（b）</td>
  </tr>
  <tr data-source-line="141">
    <td>2行目</td>
    <td class="Red">傾きの標準誤差</td>
    <td class="Blue">切片の標準誤差</td>
  </tr>
  <tr data-source-line="142">
    <td>3行目</td>
    <td>R²（決定係数）</td>
    <td>y の標準誤差</td>
  </tr>
  <tr data-source-line="143">
    <td>4行目</td>
    <td>F値</td>
    <td>自由度</td>
  </tr>
  <tr data-source-line="144">
    <td>5行目</td>
    <td>回帰平方和</td>
    <td>残差平方和</td>
  </tr>
  <tbody>
  </tbody>
</table>
<p>となり，一致しました．</p>
<p>&nbsp;</p>
<p class="Large-Bold-Red">Rにおける推定誤差</p>
<p>Rの場合でも，</p>
<p> .................................... </p>
<p>xx &lt;- c(1,2,3,4,5) </p>
<p>yy &lt;- c(3,5,8,9,10) </p>
<p>plot(xx,yy) </p>
<p>fm&lt;-nls(yy~(a0*xx+a1),start=c(a0=1,a1=5),trace=TRUE) </p>
<p>summary(fm) </p>
<p>m &lt;- lm(yy~xx) </p>
<p>abline(m) </p>
<p>summary(m) </p>
<p>.................................... </p>
<p>を実行すると，</p>
<p> Coefficients:</p>
<table width="614" border="1">
  <tr data-source-line="166">
    <th>&nbsp;</th>
    <th>Estimate</th>
    <th>Std. Error</th>
    <th>t value</th>
    <th>Pr(&gt;｜t｜)</th>
  </tr>
  <tr data-source-line="168">
    <td>(Intercept)</td>
    <td class="Blue">1.6000</td>
    <td class="Blue">0.7659</td>
    <td>2.089</td>
    <td>0.1279</td>
  </tr>
  <tr data-source-line="169">
    <td>xx</td>
    <td class="Red">1.8000</td>
    <td class="Red">0.2309</td>
    <td>7.794</td>
    <td>0.0044 **</td>
  </tr>
  <tbody>
  </tbody>
</table>
<p>となり，一致しました．</p>
<p>&nbsp;</p>
<p class="Large-Bold-Red">Pytonにおける推定誤差</p>
<p>Pythonにおいても，</p>
<p>.................................... </p>
<p>import numpy as np<br>
  import matplotlib.pyplot as plt<br>
from scipy.optimize import curve_fit</p>
<p># データ<br>
  xx = np.array([1,2,3,4,5])<br>
  yy = np.array([3,5,8,9,10])</p>
<p># モデル関数<br>
  def model(x, a0, a1):<br>
  return a0 + a1 * x</p>
<p># 初期値<br>
  p0 = [1, 1]</p>
<p># フィッティング<br>
  params, cov = curve_fit(model, xx, yy, p0=p0)</p>
<p># 推定パラメータ<br>
  a0, a1 = params</p>
<p># 標準誤差（= 共分散行列の対角成分の平方根）<br>
  stderr = np.sqrt(np.diag(cov))<br>
  se_a0, se_a1 = stderr</p>
<p>print(&quot;推定パラメータ:&quot;)<br>
  print(f&quot;a0 = {a0:.5f} ± {se_a0:.5f}&quot;)<br>
print(f&quot;a1 = {a1:.5f} ± {se_a1:.5f}&quot;)</p>
<p># 近似曲線を描くための X 軸<br>
  xx_new = np.linspace(min(xx), max(xx), 200)<br>
  yy_fit = model(xx_new, *params)</p>
<p># プロット<br>
  plt.scatter(xx, yy, label=&quot;Data&quot;)<br>
  plt.plot(xx_new, yy_fit, label=&quot;Fit&quot;, linewidth=2)<br>
  plt.xlabel(&quot;x&quot;)<br>
  plt.ylabel(&quot;y&quot;)<br>
  plt.legend()<br>
  plt.show()</p>
<p>.................................... </p>
<p>を実行すると，</p>
<p>推定パラメータ:  </p>
<p>a0 = <span class="Red">1.60000 ± 0.76594 </span></p>
<p>a1 =<span class="Blue"> 1.80000 ± 0.23094</span></p>
<p>と一致しました．</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span class="style7"><a href="gosa-11.html"><img src="L-arrow.png" alt="l" width="57" height="34" border="0" /></a><a href="kenkyu.html"><img src="TOP.png" alt="t" width="57" height="34" /></a></span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>
